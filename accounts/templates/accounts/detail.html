{% extends 'base.html' %}

{% block content %}
<div>
    <h1 class="tit">My Page</h1>
    {% if user.profile_image %}
    <div>
        <img class="prof-img" src="{{ user.profile_image.url }}" />
    </div>
    {% endif %}
    <div class="d-flex justify-content-between">
        <div>
            <h3>{{user.username }}님</h3>
            <p>{{user.email}}</p>
            <h1>가입일자:</h1>
            <h1>{{user.date_joined|date:'Y년 m월 d일 A g시 i분 s초'}}</h1>
            <!--접속여부 및 가입일-->
            <h1>마지막 로그인 시간은:</h1>
            <h1>{{user.last_login|date:'Y년 m월 d일 A g시 i분 s초'}} 입니다!</h1>
            <hr>

            <!--자기자신만 정보 수정 링크 보이게 해둠-->
            {% if request.user.pk == user.pk %}
            <a href="{% url 'accounts:update' %}" class="btnC">정보 수정</a>{% endif %}
        </div>
        <div>
            <div class="d-flex text-center">
                <div class="me-3">
                    <p>팔로잉</p>
                    <span>{{user.followings.count}}</span>
                </div>
                <div>
                    <p>팔로워</p>
                    <span>{{user.follower.count}}</span>
                </div>
            </div>
            <!--로그인 유무에 따라 팔로우 가능, 자기 자신이 팔로우 금지해둠-->
            {% if request.user != user %}
            {% if request.user.is_authenticated %}
            {% if user not in request.user.followings.all %}
            <div class="text-center">
                <a href="{% url 'accounts:follow' user.pk %}" class="btnC">follow</a>
                {% else %}
                <a href="{% url 'accounts:follow' user.pk %}" class="btnC btn-uf">unfollow</a>
            </div>
            {% endif %}
        </div>
        {% else %}
        <div>
            <a href="{% url 'accounts:login' %}">로그인하세요</a>
        </div>
        {% endif %}
        {% else %}
        <button><a href="{% url 'accounts:logout' %}">자기자신은 팔로잉할 수 없어요!</a></button>
        {% endif %}
    </div>

    <!--글작성 목록 및 갯수-->
    <hr>
    <h1>리뷰 작성 목록</h1>
    <h2>{{user.username}}님은 총{{reviews.count}}개의 리뷰를 쓰셨습니다!</h2>
    {% for review in reviews %}
    <!--차후 리뷰 목록에 갈수 있는 url 생성 이후 링크 추가목적-->
    <!--<a href="{% url 'reviews:' %}">-->{{review.title}}
    <!--</a>-->
    {% endfor %}

    <!--탈퇴 기능-->
    {% if request.user == user %}
    <a href="{% url 'accounts:dropout' %}">회원 탈퇴</a>
    {% endif %}
</div>

{% endblock content %}